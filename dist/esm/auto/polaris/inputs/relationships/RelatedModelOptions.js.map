{"version":3,"file":"RelatedModelOptions.js","sourceRoot":"","sources":["../../../../../../src/auto/polaris/inputs/relationships/RelatedModelOptions.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { AutoSelection, TextFieldProps } from \"@shopify/polaris\";\nimport { Icon, Listbox, Popover, Scrollable, TextField } from \"@shopify/polaris\";\nimport { SearchIcon } from \"@shopify/polaris-icons\";\nimport React from \"react\";\nimport type { Option } from \"../../../interfaces/AutoRelationshipInputProps.js\";\nimport { ListMessage, NoRecordsMessage, SelectableOption, getErrorMessage } from \"./PolarisListMessages.js\";\n\ntype RelatedModelOptionsProps = {\n  options: Option[];\n  records?: Record<string, any>[];\n  isLoading?: boolean;\n  errorMessage?: string;\n  checkSelected?: (id: string) => boolean;\n  onSelect: (record: Record<string, any>) => void;\n  autoSelection?: AutoSelection;\n  actions?: React.ReactNode[];\n  renderOption?: (option: Option) => React.ReactNode;\n};\n\nexport const RelatedModelOptions = (props: RelatedModelOptionsProps) => {\n  const { checkSelected, onSelect, isLoading, errorMessage, options, records, actions } = props;\n\n  const listBoxOptions = [\n    ...(actions ?? []),\n    ...options.map((option) => {\n      return props.renderOption ? (\n        props.renderOption(option)\n      ) : (\n        <SelectableOption {...option} selected={checkSelected?.(option.id) ?? false} key={option.id} />\n      );\n    }),\n  ];\n\n  return (\n    <Listbox\n      autoSelection={props.autoSelection}\n      onSelect={(id) => {\n        const record = records?.find((record) => record.id === id) ?? { id };\n        const { createdAt: _createdAt, updatedAt: _updatedAt, ...recordWithoutTimestamps } = record;\n        onSelect(recordWithoutTimestamps);\n      }}\n    >\n      {listBoxOptions.length ? (\n        listBoxOptions\n      ) : errorMessage ? (\n        <ListMessage message={getErrorMessage(errorMessage)} />\n      ) : (\n        <NoRecordsMessage />\n      )}\n      {isLoading && <Listbox.Loading accessibilityLabel=\"Loading\" />}\n    </Listbox>\n  );\n};\n\nexport const RelatedModelOptionsPopover = (\n  props: RelatedModelOptionsProps & {\n    active: boolean;\n    activator: React.ReactElement;\n    onClose: () => void;\n    search?: React.ReactNode;\n    onScrolledToBottom?: () => void;\n  }\n) => {\n  return (\n    <Popover\n      active={props.active}\n      activator={props.activator}\n      ariaHaspopup=\"listbox\"\n      preferredAlignment=\"right\"\n      autofocusTarget=\"first-node\"\n      onClose={props.onClose}\n    >\n      <Popover.Pane fixed>\n        <div\n          style={{\n            alignItems: \"stretch\",\n            borderTop: \"1px solid #DFE3E8\",\n            display: \"flex\",\n            flexDirection: \"column\",\n            justifyContent: \"stretch\",\n            position: \"relative\",\n            width: \"100%\",\n            height: \"100%\",\n            overflow: \"hidden\",\n          }}\n        >\n          {props.search}\n          <Scrollable\n            shadow\n            style={{\n              position: \"relative\",\n              width: \"310px\",\n              height: \"292px\",\n              padding: \"var(--p-space-200) 0\",\n              borderBottomLeftRadius: \"var(--p-border-radius-200)\",\n              borderBottomRightRadius: \"var(--p-border-radius-200)\",\n            }}\n            onScrolledToBottom={props.onScrolledToBottom}\n          >\n            <RelatedModelOptions\n              options={props.options}\n              records={props.records}\n              onSelect={props.onSelect}\n              isLoading={props.isLoading}\n              autoSelection={props.autoSelection}\n              renderOption={props.renderOption}\n              actions={props.actions}\n            />\n          </Scrollable>\n        </div>\n      </Popover.Pane>\n    </Popover>\n  );\n};\n\nexport const RelatedModelOptionsSearch = (\n  props: { modelName: string; label?: TextFieldProps[\"label\"]; autoComplete?: TextFieldProps[\"autoComplete\"] } & Omit<\n    TextFieldProps,\n    \"label\" | \"autoComplete\"\n  >\n) => {\n  const { modelName, label, placeholder, prefix, autoComplete, ...rest } = props;\n  return (\n    <div style={{ padding: \"12px\" }}>\n      <StopPropagation>\n        <TextField\n          labelHidden\n          autoComplete={autoComplete ?? \"off\"}\n          label={label ?? modelName}\n          placeholder={placeholder ?? `Find ${props.modelName}`}\n          prefix={prefix ?? <Icon source={SearchIcon} />}\n          {...rest}\n        />\n      </StopPropagation>\n    </div>\n  );\n};\n\nconst StopPropagation = ({ children }: React.PropsWithChildren<any>) => {\n  const stopEventPropagation = (event: React.MouseEvent | React.TouchEvent) => {\n    event.stopPropagation();\n  };\n\n  return (\n    <div onClick={stopEventPropagation} onTouchStart={stopEventPropagation}>\n      {children}\n    </div>\n  );\n};\n"]}