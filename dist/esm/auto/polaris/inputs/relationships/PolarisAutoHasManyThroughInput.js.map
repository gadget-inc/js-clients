{"version":3,"file":"PolarisAutoHasManyThroughInput.js","sourceRoot":"","sources":["../../../../../../src/auto/polaris/inputs/relationships/PolarisAutoHasManyThroughInput.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAE,QAAQ,EAAE,MAAM,kBAAkB,CAAC;AAC5C,OAAO,KAAK,EAAE,EAAE,OAAO,EAAE,MAAM,OAAO,CAAC;AACvC,OAAO,EAAE,SAAS,EAAE,MAAM,uBAAuB,CAAC;AAClD,OAAO,EAAE,gCAAgC,EAAE,MAAM,+CAA+C,CAAC;AACjG,OAAO,EAAE,wBAAwB,EAAE,sBAAsB,EAAE,MAAM,mCAAmC,CAAC;AAErG,OAAO,EAAE,mBAAmB,EAAE,MAAM,0BAA0B,CAAC;AAC/D,OAAO,EAAE,4BAA4B,EAAE,MAAM,gCAAgC,CAAC;AAE9E;;;;;;;;;;;;;;;GAeG;AACH,MAAM,CAAC,MAAM,8BAA8B,GAAG,SAAS,CAAC,CAAC,KAAiC,EAAE,EAAE;IAC5F,MAAM,EAAE,KAAK,EAAE,GAAG,KAAK,CAAC;IACxB,MAAM,EACJ,aAAa,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,EACjC,mBAAmB,EAAE,EAAE,OAAO,EAAE,mBAAmB,EAAE,MAAM,EAAE,UAAU,EAAE,YAAY,EAAE,EACvF,eAAe,EACf,YAAY,EACZ,SAAS,EACT,cAAc,EACd,cAAc,GACf,GAAG,gCAAgC,CAAC,KAAK,CAAC,CAAC;IAE5C,MAAM,WAAW,GAAG,sBAAsB,CAAC,KAAK,EAAE,KAAK,CAAC,WAAW,CAAC,CAAC;IAErE,MAAM,iBAAiB,GAAG,OAAO,CAAC,GAAG,EAAE;QACrC,OAAO,eAAe,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,MAAM,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAa,CAAC;IACrF,CAAC,EAAE,CAAC,eAAe,CAAC,CAAC,CAAC;IAEtB,OAAO,CACL;QACE,oBAAC,QAAQ,IACP,SAAS,EACP,oBAAC,QAAQ,CAAC,SAAS,IACjB,QAAQ,EAAE,MAAM,CAAC,GAAG,EACpB,KAAK,EAAE,MAAM,CAAC,KAAK,EACnB,KAAK,EAAE,KAAK,CAAC,KAAK,IAAI,QAAQ,CAAC,IAAI,EACnC,IAAI,EAAE,IAAI,EACV,WAAW,EAAC,QAAQ,EACpB,YAAY,EAAC,KAAK,EAClB,eAAe,EAAE,4BAA4B,CAAC;oBAC5C,eAAe;oBACf,cAAc;oBACd,WAAW;iBACZ,CAAC,GACF,EAEJ,kBAAkB,EAAE,UAAU,CAAC,YAAY,EAC3C,aAAa,QACb,mBAAmB,EAAE,UAAU,CAAC,WAAW,IAAI,OAAO,CAAC,MAAM,IAAI,wBAAwB;YAEzF,oBAAC,mBAAmB,IAClB,QAAQ,EAAE,cAAc,EACxB,OAAO,EAAE,YAAY,CAAC,OAAO,EAC7B,OAAO,EAAE,mBAAmB,EAC5B,aAAa,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,iBAAiB,CAAC,QAAQ,CAAC,EAAE,CAAC,EACrD,YAAY,EAAE,YAAY,EAC1B,SAAS,EAAE,SAAS,GACpB,CACO,CACV,CACJ,CAAC;AACJ,CAAC,CAAC,CAAC","sourcesContent":["import { Combobox } from \"@shopify/polaris\";\nimport React, { useMemo } from \"react\";\nimport { autoInput } from \"../../../AutoInput.js\";\nimport { useHasManyThroughInputController } from \"../../../hooks/useHasManyThroughController.js\";\nimport { optionRecordsToLoadCount, useOptionLabelForField } from \"../../../hooks/useRelatedModel.js\";\nimport type { AutoRelationshipInputProps } from \"../../../interfaces/AutoRelationshipInputProps.js\";\nimport { RelatedModelOptions } from \"./RelatedModelOptions.js\";\nimport { getSelectedRelatedRecordTags } from \"./SelectedRelatedRecordTags.js\";\n\n/**\n * A hasManyThrough field input component for use within <AutoForm></AutoForm> components\n * This component is used to configure relationships with the sibling model by creating and deleting records in the join model\n * @example\n * ```tsx\n * <AutoForm action={api.student.create}>\n *   <AutoHasManyThroughInput field=\"courses\" />\n * </AutoForm>\n * ```\n * @param props.field - The hasManyThrough field API identifier\n * @param props.label - The label of the hasManyThrough field input component\n * @param props.optionLabel - Controls how records on the related model are displayed as options in the relationship field input component.\n *                            When using a string, the string will indicate the field on the related model record to be displayed as the option label.\n *                            When using a function, the function will be called with the record to return a ReactNode to be displayed as the option label\n * @returns The hasManyThrough field input component\n */\nexport const PolarisAutoHasManyThroughInput = autoInput((props: AutoRelationshipInputProps) => {\n  const { field } = props;\n  const {\n    fieldMetadata: { path, metadata },\n    relatedModelOptions: { options, searchFilterOptions, search, pagination, relatedModel },\n    selectedRecords,\n    errorMessage,\n    isLoading,\n    onRemoveRecord,\n    onSelectRecord,\n  } = useHasManyThroughInputController(props);\n\n  const optionLabel = useOptionLabelForField(field, props.optionLabel);\n\n  const selectedRecordIds = useMemo(() => {\n    return selectedRecords.map((record) => record.id).filter((id) => !!id) as string[];\n  }, [selectedRecords]);\n\n  return (\n    <>\n      <Combobox\n        activator={\n          <Combobox.TextField\n            onChange={search.set}\n            value={search.value}\n            label={props.label ?? metadata.name}\n            name={path}\n            placeholder=\"Search\"\n            autoComplete=\"off\"\n            verticalContent={getSelectedRelatedRecordTags({\n              selectedRecords,\n              onRemoveRecord,\n              optionLabel,\n            })}\n          />\n        }\n        onScrolledToBottom={pagination.loadNextPage}\n        allowMultiple\n        willLoadMoreOptions={pagination.hasNextPage && options.length >= optionRecordsToLoadCount}\n      >\n        <RelatedModelOptions\n          onSelect={onSelectRecord}\n          records={relatedModel.records}\n          options={searchFilterOptions}\n          checkSelected={(id) => selectedRecordIds.includes(id)}\n          errorMessage={errorMessage}\n          isLoading={isLoading}\n        />\n      </Combobox>\n    </>\n  );\n});\n"]}