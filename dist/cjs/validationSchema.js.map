{"version":3,"file":"validationSchema.js","sourceRoot":"","sources":["../../src/validationSchema.tsx"],"names":[],"mappings":"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","sourcesContent":["import type { ISchema } from \"yup\";\nimport { MixedSchema, NumberSchema, StringSchema, array, boolean, date, mixed, number, object, string } from \"yup\";\nimport { fileSizeValidationErrorMessage } from \"./auto/hooks/useFileInputController.js\";\nimport type {\n  GadgetEnumConfig,\n  GadgetGenericFieldValidation,\n  GadgetObjectFieldConfig,\n  GadgetOnlyImageFileFieldValidation,\n  GadgetRangeFieldValidation,\n  GadgetRegexFieldValidation,\n} from \"./internal/gql/graphql.js\";\nimport { GadgetFieldType } from \"./internal/gql/graphql.js\";\nimport type { FieldMetadata } from \"./metadata.js\";\n\nconst richTextInputValidator = object({\n  markdown: string().required(),\n});\n\nconst validatorForField = (field: FieldMetadata) => {\n  let validator;\n  switch (field.fieldType) {\n    case GadgetFieldType.Boolean: {\n      validator = boolean();\n      break;\n    }\n    case GadgetFieldType.Code:\n    case GadgetFieldType.Password:\n    case GadgetFieldType.EncryptedString:\n    case GadgetFieldType.Color:\n    case GadgetFieldType.String: {\n      validator = string();\n      break;\n    }\n    case GadgetFieldType.DateTime: {\n      validator = date();\n      break;\n    }\n    case GadgetFieldType.Email: {\n      validator = string().email();\n      break;\n    }\n    case GadgetFieldType.Url: {\n      validator = string().url();\n      break;\n    }\n    case GadgetFieldType.Enum: {\n      const config = field.configuration as GadgetEnumConfig;\n      if (config.allowOther) {\n        validator = config.allowMultiple ? array(string()) : string();\n      } else {\n        const element = string().oneOf(config.options.map((option) => option.name));\n        validator = config.allowMultiple ? array(element) : element;\n      }\n      break;\n    }\n    case GadgetFieldType.File: {\n      validator = mixed().test(\"is-uploading\", function (value) {\n        const { path, createError } = this;\n        if (isAutoFileFieldValue(value) && value.$uploading) {\n          return createError({ path, message: \"file is still uploading\" });\n        }\n        return true;\n      });\n      break;\n    }\n    case GadgetFieldType.Number: {\n      validator = number();\n      break;\n    }\n    case GadgetFieldType.Id: {\n      validator = string();\n      break;\n    }\n    case GadgetFieldType.Json: {\n      validator = mixed().test(\"is-valid-json\", function (value) {\n        if (typeof value == \"undefined\") return true;\n        const { path, createError } = this;\n\n        if (isFailedJSONParse(value)) {\n          return createError({ path, message: value.error.message });\n        }\n        return true;\n      });\n\n      break;\n    }\n    case GadgetFieldType.RecordState:\n    case GadgetFieldType.Any: {\n      validator = mixed();\n      break;\n    }\n    case GadgetFieldType.Money: {\n      validator = string();\n      break;\n    }\n    case GadgetFieldType.Object: {\n      const config = field.configuration as GadgetObjectFieldConfig;\n      validator = validationSchema(config.fields as any);\n      break;\n    }\n    case GadgetFieldType.RichText: {\n      validator = richTextInputValidator;\n      break;\n    }\n    case GadgetFieldType.RoleAssignments: {\n      validator = array(string());\n      break;\n    }\n    case GadgetFieldType.Vector: {\n      validator = array(number());\n      break;\n    }\n    case GadgetFieldType.BelongsTo:\n    case GadgetFieldType.HasOne: {\n      // TODO: implement relationship validations\n      validator = object();\n      break;\n    }\n    case GadgetFieldType.HasManyThrough:\n    case GadgetFieldType.HasMany: {\n      // TODO: implement relationship validations\n      validator = array();\n      break;\n    }\n\n    case GadgetFieldType.Array: {\n      validator = array();\n      break;\n    }\n\n    default: {\n      throw new Error(`unknown field type ${field.fieldType} for validator generation`);\n    }\n  }\n\n  if (field.requiredArgumentForInput) {\n    validator = validator.required();\n  } else {\n    validator = (validator.nullable() as any).default(null);\n  }\n\n  for (const validation of field.configuration.validations) {\n    switch (validation?.__typename) {\n      case \"GadgetRangeFieldValidation\": {\n        const { min, max } = validation as GadgetRangeFieldValidation;\n        if (validator instanceof StringSchema || validator instanceof NumberSchema) {\n          if (min) validator = validator.min(min);\n          if (max) validator = validator.max(max);\n        } else if (field.fieldType === GadgetFieldType.File && validator instanceof MixedSchema) {\n          validator = validator.test(\"is-valid-file-size\", function (value) {\n            const { path, createError } = this;\n\n            if (isAutoFileFieldValue(value) && value.$invalidFileSize) {\n              return createError({\n                path,\n                message: fileSizeValidationErrorMessage(validation, value.$invalidFileSize),\n              });\n            }\n\n            return true;\n          });\n        }\n        break;\n      }\n\n      case \"GadgetRegexFieldValidation\": {\n        const regexValidation = validation as GadgetRegexFieldValidation;\n        if (regexValidation.pattern && validator instanceof StringSchema) {\n          validator = validator.matches(new RegExp(regexValidation.pattern));\n        }\n        break;\n      }\n\n      case \"GadgetOnlyImageFileFieldValidation\": {\n        if (validator instanceof MixedSchema) {\n          validator = validator.test(\"is-valid-image-file\", function (value) {\n            const { allowAnimatedImages } = validation as GadgetOnlyImageFileFieldValidation;\n\n            if (typeof value == \"undefined\") return true;\n            const { path, createError } = this;\n\n            if (isAutoFileFieldValue(value)) {\n              if (!value.mimeType.startsWith(\"image/\")) {\n                return createError({ path, message: `must be a valid image file type; file type was detected as \"${value.mimeType}\"` });\n              }\n\n              if (!allowAnimatedImages && value.mimeType === \"image/gif\") {\n                return createError({ path, message: \"must not be an animated image file\" });\n              }\n            }\n\n            return true;\n          });\n        }\n\n        break;\n      }\n\n      case \"GadgetGenericFieldValidation\": {\n        const { specID } = validation as GadgetGenericFieldValidation;\n        validator = addGadgetGenericFieldValidation(validator, specID);\n        break;\n      }\n    }\n  }\n\n  return validator;\n};\n\nconst addGadgetGenericFieldValidation = (validator: any, validationSpecId: string) => {\n  switch (validationSpecId) {\n    case ColorValidationSpecId: {\n      return validator.matches(colorRegex, \"Must be a color\");\n    }\n\n    case EmailValidationSpecId: {\n      return validator.email();\n    }\n\n    case StrongPasswordValidationSpecId: {\n      return validator.matches(strongPasswordRegex, \"Must contain at least 8 characters, 1 number and 1 special character\");\n    }\n\n    case UrlValidationSpecId: {\n      return validator.url();\n    }\n\n    default: {\n      return validator;\n    }\n  }\n};\n\nconst EmailValidationSpecId = \"gadget/validation/email-address\";\nconst ColorValidationSpecId = \"gadget/validation/color\";\nconst StrongPasswordValidationSpecId = \"gadget/validation/password\";\nconst UrlValidationSpecId = \"gadget/validation/url\";\nexport const RequiredValidationSpecId = \"gadget/validation/required\";\n\nconst colorRegex = new RegExp(/^#([0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/);\nconst strongPasswordRegex = new RegExp(\"^(?=.*\\\\d)(?=.*[!@#$%^&*\\\\-=_+\\\\[\\\\]{}|;:'\\\",.<>/?])(.{8,})$\");\n\nexport interface FailedJSONParse {\n  $failedParse: true;\n  error: Error;\n  raw: string;\n}\nexport const isFailedJSONParse = (value: any): value is FailedJSONParse => {\n  return value && typeof value == \"object\" && \"$failedParse\" in value;\n};\n\n/**\n * Build a Yup validation schema given some fields metadata for validating that a data object conforms to the schema at runtime\n */\nexport const validationSchema = (fields: FieldMetadata[]) => {\n  const validators: Record<string, ISchema<any>> = {};\n  for (const field of fields) {\n    validators[field.apiIdentifier] = validatorForField(field);\n  }\n  return object(validators);\n};\n\nexport interface AutoFileFieldValue {\n  fileName: string;\n  mimeType: string;\n  url?: string;\n  directUploadToken?: string;\n  $uploading?: boolean;\n  $invalidFileSize?: number;\n}\n\nexport const isAutoFileFieldValue = (value: any): value is AutoFileFieldValue => {\n  return typeof value === \"object\" && value !== null && \"mimeType\" in value && \"fileName\" in value;\n};\n"]}