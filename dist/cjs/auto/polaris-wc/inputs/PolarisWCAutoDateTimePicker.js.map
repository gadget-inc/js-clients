{"version":3,"file":"PolarisWCAutoDateTimePicker.js","sourceRoot":"","sources":["../../../../../src/auto/polaris-wc/inputs/PolarisWCAutoDateTimePicker.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useCallback } from \"react\";\nimport { isValidDate, utcToZonedTime, zonedTimeToUtc } from \"../../../dateTimeUtils.js\";\nimport type { GadgetDateTimeConfig } from \"../../../internal/gql/graphql.js\";\nimport { autoInput } from \"../../AutoInput.js\";\nimport { useDateTimeField } from \"../../hooks/useDateTimeField.js\";\nimport type { AutoDateTimeInputProps, StringOnlyLabel } from \"../../shared/AutoInputTypes.js\";\n\nexport type PolarisWCAutoDateTimePickerProps = StringOnlyLabel<AutoDateTimeInputProps> & {\n  /**\n   * The HTML ID of the DateTime field.\n   */\n  id?: string;\n  /**\n   * Hides the time input.\n   */\n  hideTime?: boolean;\n};\n\n/**\n * A date and time picker within AutoForm using Polaris Web Components.\n * @example\n * ```tsx\n * <AutoForm action={api.modelA.create}>\n *   <AutoDateTimePicker field=\"dueDate\" />\n * </AutoForm>\n * ```\n * @param props.field - The API identifier of the DateTime field.\n * @param props.label - Label of the DateTime picker.\n * @param props.hideTime - Hide the time input.\n * @returns The AutoDateTimePicker component.\n */\nexport const PolarisWCAutoDateTimePicker = autoInput((props: PolarisWCAutoDateTimePickerProps) => {\n  const { localTz, localTime, fieldProps, metadata, fieldState } = useDateTimeField(props);\n  const { onChange, value } = fieldProps;\n\n  const config = metadata.configuration as GadgetDateTimeConfig;\n  const includeTime = config.includeTime && !props.hideTime;\n\n  const handleDateChange = useCallback(\n    (event: Event) => {\n      const target = event.currentTarget as any;\n      const dateValue = target.value;\n\n      if (!dateValue) {\n        onChange(null);\n        return;\n      }\n\n      // Parse the date string (YYYY-MM-DD format from date input)\n      const [year, month, day] = dateValue.split(\"-\").map(Number);\n      const newDate = new Date(year, month - 1, day);\n\n      // Preserve existing time if there is one\n      if (value && isValidDate(new Date(value))) {\n        const existingDate = utcToZonedTime(new Date(value), localTz);\n        newDate.setHours(existingDate.getHours());\n        newDate.setMinutes(existingDate.getMinutes());\n        newDate.setSeconds(existingDate.getSeconds());\n        newDate.setMilliseconds(existingDate.getMilliseconds());\n      }\n\n      onChange(zonedTimeToUtc(newDate, localTz));\n    },\n    [onChange, value, localTz]\n  );\n\n  const handleTimeChange = useCallback(\n    (event: Event) => {\n      const target = event.currentTarget as any;\n      const timeValue = target.value;\n\n      if (!timeValue || !value) {\n        return;\n      }\n\n      // Parse the time string (HH:MM format from time input)\n      const [hours, minutes] = timeValue.split(\":\").map(Number);\n      const currentDate = utcToZonedTime(new Date(value), localTz);\n      currentDate.setHours(hours);\n      currentDate.setMinutes(minutes);\n\n      onChange(zonedTimeToUtc(currentDate, localTz));\n    },\n    [onChange, value, localTz]\n  );\n\n  // Format date for the input (YYYY-MM-DD)\n  const dateInputValue = localTime\n    ? `${localTime.getFullYear()}-${String(localTime.getMonth() + 1).padStart(2, \"0\")}-${String(localTime.getDate()).padStart(2, \"0\")}`\n    : \"\";\n\n  // Format time for the input (HH:MM)\n  const timeInputValue = localTime\n    ? `${String(localTime.getHours()).padStart(2, \"0\")}:${String(localTime.getMinutes()).padStart(2, \"0\")}`\n    : \"\";\n\n  return (\n    <div style={{ display: \"flex\", gap: \"16px\", alignItems: \"flex-start\" }}>\n      <s-date-field\n        id={props.id ? `${props.id}-date` : undefined}\n        label={typeof props.label === \"string\" ? props.label : String(metadata.name ?? \"Date\")}\n        value={dateInputValue}\n        required={metadata.requiredArgumentForInput}\n        error={props.error ?? fieldState.error?.message}\n        onChange={handleDateChange}\n      />\n      {includeTime && (\n        <div style={{ width: \"130px\" }}>\n          <s-text-field\n            id={props.id ? `${props.id}-time` : undefined}\n            label=\"Time\"\n            {...({ type: \"time\" } as any)}\n            value={timeInputValue}\n            onChange={handleTimeChange}\n          />\n        </div>\n      )}\n    </div>\n  );\n});\n"]}