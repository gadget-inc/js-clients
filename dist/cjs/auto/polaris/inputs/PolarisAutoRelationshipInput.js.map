{"version":3,"file":"PolarisAutoRelationshipInput.js","sourceRoot":"","sources":["../../../../../src/auto/polaris/inputs/PolarisAutoRelationshipInput.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Combobox, Icon, Listbox, Tag, Text } from \"@shopify/polaris\";\nimport { SearchIcon } from \"@shopify/polaris-icons\";\nimport React from \"react\";\nimport { ErrorWrapper } from \"../../../utils.js\";\nimport { numberOfRecordsToLoad, useRelationshipInputController } from \"../../hooks/useRelationshipInputController.js\";\nimport { AutoRelationshipInputProps } from \"../../interfaces/AutoRelationshipInputProps.js\";\n\nexport const PolarisAutoBelongsToInput = (props: AutoRelationshipInputProps) => {\n  return <PolarisAutoRelationshipInput {...props} />;\n};\n\nexport const PolarisAutoRelationshipInput = (props: AutoRelationshipInputProps) => {\n  const { field, control, optionLabel } = props;\n\n  const { path, isHasMany, relatedModel, metadata, pagination, search, selection } = useRelationshipInputController({\n    field: field,\n    control: control,\n    optionLabel: optionLabel,\n  });\n\n  if (isHasMany) {\n    // TODO - Update to account for HasMany relationship. Multiselect functionality and more advanced hook\n    return null;\n  }\n\n  const selectedRecordTag = (\n    <Tag onRemove={() => selection.set(undefined)}>\n      <p style={{ color: selection.error ? \"red\" : undefined }} id={`${selection.id}_${selection.label}`}>\n        {selection.label}\n      </p>\n    </Tag>\n  );\n\n  return (\n    <Combobox\n      activator={\n        <Combobox.TextField\n          prefix={<Icon source={SearchIcon} />}\n          onChange={search.set}\n          value={search.value}\n          label={metadata.name}\n          name={path}\n          placeholder=\"Search\"\n          autoComplete=\"off\"\n          verticalContent={selection.id && selectedRecordTag}\n        />\n      }\n      onScrolledToBottom={pagination.loadNextPageOfRecords}\n      onClose={pagination.resetPagination}\n      willLoadMoreOptions={relatedModel.hasNextPage && relatedModel.options.length >= numberOfRecordsToLoad}\n    >\n      <RelatedModelOptions relatedModel={relatedModel} selection={selection} />\n    </Combobox>\n  );\n};\n\nexport const RelatedModelOptions = (props: {\n  relatedModel: { options: any[]; error?: ErrorWrapper; hasNextPage: boolean; isLoadingRelatedRecords: boolean };\n  selection: { id?: string; label: string; error?: ErrorWrapper; set: (selectedId?: string | undefined) => void };\n}) => {\n  const { relatedModel, selection } = props;\n\n  return (\n    <Listbox onSelect={(recordId) => selection.set(selection.id === recordId ? undefined : recordId)}>\n      {relatedModel.options.length ? (\n        relatedModel.options.map((option) => (\n          <SelectableOption {...option} selected={selection.id === option.recordId} key={option.recordId} />\n        ))\n      ) : (\n        <NoRecordsMessage />\n      )}\n      {relatedModel.isLoadingRelatedRecords && <Listbox.Loading accessibilityLabel=\"Loading\" />}\n    </Listbox>\n  );\n};\n\nconst SelectableOption = (props: { label: string; recordId: string; selected: boolean }) => {\n  const { label, recordId, selected } = props;\n  return (\n    <Listbox.Option key={recordId} value={recordId} selected={selected}>\n      {label}\n    </Listbox.Option>\n  );\n};\n\nconst NoRecordsMessage = () => (\n  <div style={{ padding: \"16px\" }}>\n    <Text as=\"p\" tone=\"subdued\">\n      No records found\n    </Text>\n  </div>\n);\n"]}