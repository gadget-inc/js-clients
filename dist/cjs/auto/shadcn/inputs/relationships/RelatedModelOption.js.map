{"version":3,"file":"RelatedModelOption.js","sourceRoot":"","sources":["../../../../../../src/auto/shadcn/inputs/relationships/RelatedModelOption.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useMemo } from \"react\";\nimport type { Option } from \"../../../interfaces/AutoRelationshipInputProps.js\";\nimport type { ShadcnElements } from \"../../elements.js\";\nimport { makeShadcnListMessages } from \"./ShadcnListMessages.js\";\n\nexport type RelatedModelOptionsProps = {\n  options: Option[];\n  records?: Record<string, any>[];\n  isLoading?: boolean;\n  errorMessage?: string;\n  checkSelected?: (id: string) => boolean;\n  onSelect: (record: Record<string, any>) => void;\n  actions?: React.ReactNode[];\n  renderOption?: (option: Option) => React.ReactNode;\n  allowMultiple?: boolean;\n  allowOther?: boolean;\n  searchValue?: string;\n  onAddExtraOption?: (value: string) => void;\n  formatOptionText?: (option: string) => React.ReactNode;\n  setSearchValue?: (value: string) => void;\n  emptyMessage?: string;\n};\n\nexport const makeRelatedModelOption = (\n  elements: Pick<ShadcnElements, \"CommandItem\" | \"CommandList\" | \"CommandEmpty\" | \"CommandGroup\" | \"Checkbox\" | \"Label\">\n) => {\n  const { CommandList, CommandEmpty, CommandGroup } = elements;\n\n  function RelatedModelOption(props: RelatedModelOptionsProps) {\n    const { checkSelected, onSelect, isLoading, errorMessage, options, records, actions } = props;\n\n    const { ListMessage, NoRecordsMessage, ShadcnSelectableOption, getErrorMessage, AddExtraOption } = makeShadcnListMessages(elements);\n\n    const listBoxOptions = useMemo(\n      () => [\n        ...(actions ?? []),\n        ...options.map((option) => {\n          return props.renderOption ? (\n            props.renderOption(option)\n          ) : (\n            <ShadcnSelectableOption\n              {...option}\n              selected={checkSelected?.(option.id) ?? false}\n              allowMultiple={props.allowMultiple}\n              onSelect={(id) => {\n                const record = records?.find((record) => record.id === id) ?? { id };\n                const { createdAt: _createdAt, updatedAt: _updatedAt, ...recordWithoutTimestamps } = record;\n                onSelect(recordWithoutTimestamps);\n              }}\n              key={option.id}\n            />\n          );\n        }),\n      ],\n      [actions, options, props.renderOption, records, checkSelected, onSelect]\n    );\n\n    return (\n      <CommandList>\n        {isLoading ? (\n          <CommandEmpty>Loading...</CommandEmpty>\n        ) : props.allowOther ? (\n          <ListMessage\n            message={`Add \"${props.searchValue}\"`}\n            onSelect={() => {\n              props.onAddExtraOption?.(props.searchValue ?? \"\");\n              props.setSearchValue?.(\"\");\n            }}\n          />\n        ) : (\n          <NoRecordsMessage message={props.emptyMessage} />\n        )}\n        {listBoxOptions.length ? (\n          <CommandGroup>\n            {listBoxOptions}\n            {props.allowOther && props.searchValue && (\n              <AddExtraOption\n                message={`Add \"${props.searchValue}\"`}\n                onSelect={() => {\n                  props.onAddExtraOption?.(props.searchValue ?? \"\");\n                  props.setSearchValue?.(\"\");\n                }}\n              />\n            )}\n          </CommandGroup>\n        ) : errorMessage ? (\n          <ListMessage message={getErrorMessage(errorMessage)} />\n        ) : (\n          <NoRecordsMessage />\n        )}\n      </CommandList>\n    );\n  }\n\n  RelatedModelOption.displayName = \"RelatedModelOption\";\n\n  return RelatedModelOption;\n};\n"]}