{"version":3,"file":"RelatedModelOption.js","sourceRoot":"","sources":["../../../../../../src/auto/shadcn/inputs/relationships/RelatedModelOption.tsx"],"names":[],"mappings":";;;;AAAA,+CAA0C;AAC1C,uDAAuC;AAGvC,mEAAiE;AAqB1D,MAAM,sBAAsB,GAAG,CACpC,QAAsH,EACtH,EAAE;IACF,MAAM,EAAE,WAAW,EAAE,YAAY,EAAE,YAAY,EAAE,WAAW,EAAE,GAAG,QAAQ,CAAC;IAE1E,SAAS,kBAAkB,CAAC,KAA+B;QACzD,MAAM,EAAE,aAAa,EAAE,QAAQ,EAAE,SAAS,EAAE,YAAY,EAAE,OAAO,EAAE,OAAO,EAAE,OAAO,EAAE,GAAG,KAAK,CAAC;QAE9F,MAAM,EAAE,gBAAgB,EAAE,sBAAsB,EAAE,eAAe,EAAE,cAAc,EAAE,GAAG,IAAA,8CAAsB,EAAC,QAAQ,CAAC,CAAC;QAEvH,MAAM,cAAc,GAAG,IAAA,eAAO,EAC5B,GAAG,EAAE,CAAC;YACJ,GAAG,CAAC,OAAO,IAAI,EAAE,CAAC;YAClB,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM,EAAE,EAAE;gBACxB,OAAO,KAAK,CAAC,YAAY,CAAC,CAAC,CAAC,CAC1B,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,CAC3B,CAAC,CAAC,CAAC,CACF,8BAAC,sBAAsB,OACjB,MAAM,EACV,QAAQ,EAAE,aAAa,EAAE,CAAC,MAAM,CAAC,EAAE,CAAC,IAAI,KAAK,EAC7C,aAAa,EAAE,KAAK,CAAC,aAAa,EAClC,QAAQ,EAAE,CAAC,EAAE,EAAE,EAAE;wBACf,MAAM,MAAM,GAAG,OAAO,EAAE,IAAI,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,EAAE,KAAK,EAAE,CAAC,IAAI,EAAE,EAAE,EAAE,CAAC;wBACrE,MAAM,EAAE,SAAS,EAAE,UAAU,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,uBAAuB,EAAE,GAAG,MAAM,CAAC;wBAC5F,QAAQ,CAAC,uBAAuB,CAAC,CAAC;oBACpC,CAAC,EACD,GAAG,EAAE,MAAM,CAAC,EAAE,GACd,CACH,CAAC;YACJ,CAAC,CAAC;SACH,EACD,CAAC,OAAO,EAAE,OAAO,EAAE,KAAK,CAAC,YAAY,EAAE,OAAO,EAAE,aAAa,EAAE,QAAQ,CAAC,CACzE,CAAC;QAEF,OAAO,CACL,8BAAC,WAAW;YACT,SAAS,IAAI,8BAAC,YAAY,qBAA0B;YACpD,cAAc,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,8BAAC,YAAY,QAAE,cAAc,CAAgB,CAAC,CAAC,CAAC,IAAI;YAChF,KAAK,CAAC,UAAU,IAAI,KAAK,CAAC,WAAW,IAAI,CACxC,8BAAC,cAAc,IACb,OAAO,EAAE,QAAQ,KAAK,CAAC,WAAW,GAAG,EACrC,QAAQ,EAAE,GAAG,EAAE;oBACb,KAAK,CAAC,gBAAgB,EAAE,CAAC,KAAK,CAAC,WAAW,IAAI,EAAE,CAAC,CAAC;oBAClD,KAAK,CAAC,cAAc,EAAE,CAAC,EAAE,CAAC,CAAC;gBAC7B,CAAC,GACD,CACH;YACA,YAAY,CAAC,CAAC,CAAC,CACd,8BAAC,gBAAgB,IAAC,OAAO,EAAE,eAAe,CAAC,YAAY,CAAC,GAAI,CAC7D,CAAC,CAAC,CAAC,CACF,CAAC,SAAS,IAAI,8BAAC,gBAAgB,IAAC,OAAO,EAAE,KAAK,CAAC,YAAY,IAAI,SAAS,GAAI,CAC7E;YACA,KAAK,CAAC,WAAW,IAAI,CACpB,8BAAC,WAAW,IACV,GAAG,EAAE,KAAK,CAAC,WAAW,EACtB,GAAG,EAAC,sBAAsB,EAC1B,SAAS,EAAC,kEAAkE;gBAE5E,8BAAC,yBAAU,IAAC,SAAS,EAAC,sBAAsB,GAAG,CACnC,CACf,CACW,CACf,CAAC;IACJ,CAAC;IAED,kBAAkB,CAAC,WAAW,GAAG,oBAAoB,CAAC;IAEtD,OAAO,EAAE,kBAAkB,EAAE,CAAC;AAChC,CAAC,CAAC;AApEW,QAAA,sBAAsB,0BAoEjC","sourcesContent":["import { LoaderIcon } from \"lucide-react\";\nimport React, { useMemo } from \"react\";\nimport type { Option } from \"../../../interfaces/AutoRelationshipInputProps.js\";\nimport type { ShadcnElements } from \"../../elements.js\";\nimport { makeShadcnListMessages } from \"./ShadcnListMessages.js\";\n\nexport type RelatedModelOptionsProps = {\n  options: Option[];\n  records?: Record<string, any>[];\n  isLoading?: boolean;\n  errorMessage?: string;\n  checkSelected?: (id: string) => boolean;\n  onSelect: (record: Record<string, any>) => void;\n  actions?: React.ReactNode[];\n  renderOption?: (option: Option) => React.ReactNode;\n  allowMultiple?: boolean;\n  allowOther?: boolean;\n  searchValue?: string;\n  onAddExtraOption?: (value: string) => void;\n  formatOptionText?: (option: string) => React.ReactNode;\n  setSearchValue?: (value: string) => void;\n  emptyMessage?: string;\n  loadMoreRef?: React.RefObject<HTMLDivElement>;\n};\n\nexport const makeRelatedModelOption = (\n  elements: Pick<ShadcnElements, \"CommandItem\" | \"CommandList\" | \"CommandEmpty\" | \"CommandGroup\" | \"Checkbox\" | \"Label\">\n) => {\n  const { CommandList, CommandEmpty, CommandGroup, CommandItem } = elements;\n\n  function RelatedModelOption(props: RelatedModelOptionsProps) {\n    const { checkSelected, onSelect, isLoading, errorMessage, options, records, actions } = props;\n\n    const { NoRecordsMessage, ShadcnSelectableOption, getErrorMessage, AddExtraOption } = makeShadcnListMessages(elements);\n\n    const listBoxOptions = useMemo(\n      () => [\n        ...(actions ?? []),\n        ...options.map((option) => {\n          return props.renderOption ? (\n            props.renderOption(option)\n          ) : (\n            <ShadcnSelectableOption\n              {...option}\n              selected={checkSelected?.(option.id) ?? false}\n              allowMultiple={props.allowMultiple}\n              onSelect={(id) => {\n                const record = records?.find((record) => record.id === id) ?? { id };\n                const { createdAt: _createdAt, updatedAt: _updatedAt, ...recordWithoutTimestamps } = record;\n                onSelect(recordWithoutTimestamps);\n              }}\n              key={option.id}\n            />\n          );\n        }),\n      ],\n      [actions, options, props.renderOption, records, checkSelected, onSelect]\n    );\n\n    return (\n      <CommandList>\n        {isLoading && <CommandEmpty>Loading...</CommandEmpty>}\n        {listBoxOptions.length > 0 ? <CommandGroup>{listBoxOptions}</CommandGroup> : null}\n        {props.allowOther && props.searchValue && (\n          <AddExtraOption\n            message={`Add \"${props.searchValue}\"`}\n            onSelect={() => {\n              props.onAddExtraOption?.(props.searchValue ?? \"\");\n              props.setSearchValue?.(\"\");\n            }}\n          />\n        )}\n        {errorMessage ? (\n          <NoRecordsMessage message={getErrorMessage(errorMessage)} />\n        ) : (\n          !isLoading && <NoRecordsMessage message={props.emptyMessage ?? undefined} />\n        )}\n        {props.loadMoreRef && (\n          <CommandItem\n            ref={props.loadMoreRef}\n            key=\"intersection-trigger\"\n            className=\"p-1 w-full flex items-center justify-center intersection-trigger\"\n          >\n            <LoaderIcon className=\"w-4 h-4 animate-spin\" />\n          </CommandItem>\n        )}\n      </CommandList>\n    );\n  }\n\n  RelatedModelOption.displayName = \"RelatedModelOption\";\n\n  return { RelatedModelOption };\n};\n"]}