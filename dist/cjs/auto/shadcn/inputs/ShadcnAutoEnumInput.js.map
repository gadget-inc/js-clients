{"version":3,"file":"ShadcnAutoEnumInput.js","sourceRoot":"","sources":["../../../../../src/auto/shadcn/inputs/ShadcnAutoEnumInput.tsx"],"names":[],"mappings":"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","sourcesContent":["import { XIcon } from \"lucide-react\";\nimport React, { useCallback } from \"react\";\nimport type { Control } from \"../../../useActionForm.js\";\nimport { debounce } from \"../../../utils.js\";\nimport { autoInput } from \"../../AutoInput.js\";\nimport { useEnumInputController } from \"../../hooks/useEnumInputController.js\";\nimport type { ShadcnElements } from \"../elements.js\";\nimport { makeShadcnAutoComboInput } from \"./ShadcnAutoComboInput.js\";\n\nexport const makeShadcnAutoEnumInput = ({\n  Badge,\n  Button,\n  Command,\n  CommandItem,\n  CommandLoading,\n  CommandInput,\n  Label,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  Checkbox,\n  ScrollArea,\n}: Pick<\n  ShadcnElements,\n  | \"Badge\"\n  | \"Button\"\n  | \"Command\"\n  | \"CommandItem\"\n  | \"CommandList\"\n  | \"CommandEmpty\"\n  | \"CommandLoading\"\n  | \"CommandGroup\"\n  | \"CommandInput\"\n  | \"Label\"\n  | \"Checkbox\"\n  | \"ScrollArea\"\n  | \"Input\"\n>) => {\n  const ShadcnComboInput = makeShadcnAutoComboInput({\n    Command,\n    CommandInput,\n    CommandLoading,\n    Label,\n    CommandItem,\n    CommandList,\n    CommandEmpty,\n    CommandGroup,\n    Checkbox,\n    ScrollArea,\n  });\n\n  function ShadcnAutoEnumInput(props: { field: string; control?: Control<any>; label?: string }) {\n    const { field: fieldApiIdentifier, control, label: labelProp, ...comboboxProps } = props;\n    const {\n      allowMultiple,\n      allowOther,\n      onSelectionChange,\n      selectedOptions,\n      allOptions,\n      filteredOptions,\n      searchQuery,\n      label,\n      metadata,\n      isError,\n      errorMessage,\n    } = useEnumInputController({ field: fieldApiIdentifier, control });\n\n    const { value: searchValue, setValue: setSearchValue } = searchQuery;\n\n    let selectedTagsElement = null;\n    if (selectedOptions.length > 0) {\n      selectedTagsElement = (\n        <div className=\"flex flex-wrap gap-2\">\n          {selectedOptions.map((tag) => (\n            <Badge key={`option-${tag}`} variant={\"outline\"}>\n              {tag}\n              <Button variant=\"ghost\" size=\"icon\" aria-label={`Remove ${tag}`} onClick={() => onSelectionChange(tag)}>\n                <XIcon />\n              </Button>\n            </Badge>\n          ))}\n        </div>\n      );\n    }\n\n    const formatOptionText = useCallback(\n      (option: string) => {\n        const trimValue = searchValue.trim().toLocaleLowerCase();\n        const matchIndex = option.toLocaleLowerCase().indexOf(trimValue);\n\n        if (!searchValue || matchIndex === -1) return option;\n\n        const start = option.slice(0, matchIndex);\n        const highlight = option.slice(matchIndex, matchIndex + trimValue.length);\n        const end = option.slice(matchIndex + trimValue.length, option.length);\n\n        return (\n          <p>\n            {start}\n            <span className=\"font-bold\">{highlight}</span>\n            {end}\n          </p>\n        );\n      },\n      [searchValue]\n    );\n\n    const debouncedSearch = useCallback(\n      debounce((value: string) => {\n        setSearchValue(value);\n      }, 400),\n      [setSearchValue]\n    );\n\n    return (\n      <ShadcnComboInput\n        {...props}\n        options={filteredOptions.map((option) => ({ id: option, label: option }))}\n        path={labelProp ?? label}\n        metadata={metadata}\n        label={labelProp ?? label}\n        onChange={debouncedSearch}\n        selectedRecordTag={selectedTagsElement}\n        onSelect={(option) => {\n          onSelectionChange(option.id);\n        }}\n        isLoading={false}\n        checkSelected={(id) => {\n          return selectedOptions.includes(id);\n        }}\n        id={`${props.field}-combobox-textfield`}\n        errorMessage={errorMessage}\n        allowMultiple={allowMultiple}\n        records={[]}\n        allowOther={allowOther}\n        onAddExtraOption={(value) => {\n          onSelectionChange(value);\n          setSearchValue(\"\");\n        }}\n        formatOptionText={formatOptionText}\n        emptyMessage={`No options found matching `}\n      />\n    );\n  }\n\n  return autoInput(ShadcnAutoEnumInput);\n};\n"]}